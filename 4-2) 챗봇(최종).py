{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import logging\n",
    "from telegram import ForceReply ,ReplyKeyboardRemove, Update, ReplyKeyboardMarkup\n",
    "from telegram.ext import Updater, CommandHandler, MessageHandler, Filters, CallbackContext, ConversationHandler\n",
    "\n",
    "import pandas as pd\n",
    "\n",
    "import time\n",
    "from telegram import ChatAction\n",
    "from telegram import InlineKeyboardButton, InlineKeyboardMarkup\n",
    "from telegram.ext import Updater\n",
    "from telegram.ext import CommandHandler, CallbackQueryHandler\n",
    "\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import cx_Oracle\n",
    "\n",
    "from sqlalchemy.orm import sessionmaker\n",
    "from sqlalchemy import *\n",
    "\n",
    "from telegram import InlineKeyboardButton as BT\n",
    "from telegram import InlineKeyboardMarkup as MU\n",
    "\n",
    "import findpolicy\n",
    "\n",
    "from konlpy.tag import Mecab \n",
    "\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "# mecab ì‹¤í–‰\n",
    "\n",
    "mecab = Mecab(dicpath=r\"C:\\Mecab\\mecab-ko-dic\") # dictation path ì„¤ì • / mecab-ko-dicì´ mecabì˜ ë‹¨ì–´ì‚¬ì „ì„"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "# ì˜¤ë¼í´ ì—”ì§„ ê°€ë™ - ì—”ì§„ë§Œ ê°€ë™í•˜ë©´ tableì€ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŒ.\n",
    "engine = create_engine('oracle://c##biganalysis:1234@localhost:1521/orcl')\n",
    "\n",
    "# Sessionì„ ì‹¤í–‰ì‹œì¼œì•¼ ì¿¼ë¦¬ ì‹¤í–‰ ê°€ëŠ¥\n",
    "\n",
    "Session = sessionmaker()\n",
    "Session.configure(bind=engine)\n",
    "session = Session()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "import telegram\n",
    "\n",
    "token = '2133514246:AAGGBP1skx5GyvRBW9AzL7_QKe87-JdZIrw'\n",
    "id = '2033550924'\n",
    "mc = '2033550924'# ID\n",
    "\n",
    "bot = telegram.Bot(token = token)\n",
    "updates = bot.getUpdates()\n",
    "for u in updates:\n",
    "    print(u.message)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "#ë²„íŠ¼ ëª©ë¡\n",
    "\n",
    "# ìƒë‹´ê¸€ ì €ì¥ ë™ì˜ ë²„íŠ¼\n",
    "agree1_first = BT(text = 'ì˜ˆ', callback_data = 'ì˜ˆ')\n",
    "agree2_first = BT(text = 'ì•„ë‹ˆì˜¤', callback_data = 'ì•„ë‹ˆì˜¤')\n",
    "agree_mu_first = MU(inline_keyboard = [[agree1_first, agree2_first]])\n",
    "\n",
    "# ê°œì¸ì •ë³´ ë™ì˜ ë²„íŠ¼\n",
    "agree1 = BT(text = 'ë™ì˜', callback_data = 'ë™ì˜')\n",
    "agree2 = BT(text = 'ë¹„ë™ì˜', callback_data = 'ë¹„ë™ì˜')\n",
    "agree_mu = MU(inline_keyboard = [[agree1, agree2]])\n",
    "\n",
    "#ìê²©ìš”ê±´ - ë‚˜ì´\n",
    "age1 = BT(text = '15 ë¯¸ë§Œ', callback_data = '00-15')\n",
    "age2 = BT(text = '15-18', callback_data = '15-18')\n",
    "age3 = BT(text = '19-24', callback_data = '19-24')\n",
    "age4 = BT(text = '25-34', callback_data = '25-34')\n",
    "age5 = BT(text = '35-39', callback_data = '35-39')\n",
    "age6 = BT(text = '40ì´ìƒ', callback_data = '40~99')\n",
    "age_mu = MU(inline_keyboard = [[age1, age2, age3],[age4, age5, age6]])\n",
    "\n",
    "#ìê²©ìš”ê±´ - ì§€ì—­\n",
    "reg1 = BT(text = 'ê°•ì›ë„', callback_data = 'ê°•ì›ë„')\n",
    "reg2 = BT(text = 'ê²½ê¸°ë„', callback_data = 'ê²½ê¸°ë„')\n",
    "reg3= BT(text = 'ê²½ìƒë‚¨ë„', callback_data = 'ê²½ìƒë‚¨ë„')\n",
    "reg4 = BT(text = 'ê²½ìƒë¶ë„', callback_data = 'ê²½ìƒë¶ë„')\n",
    "reg5 = BT(text = 'ê´‘ì£¼ê´‘ì—­ì‹œ', callback_data = 'ê´‘ì£¼ê´‘ì—­ì‹œ')\n",
    "reg6 = BT(text = 'ëŒ€êµ¬ê´‘ì—­ì‹œ', callback_data = 'ëŒ€êµ¬ê´‘ì—­ì‹œ')\n",
    "reg7 = BT(text = 'ëŒ€ì „ê´‘ì—­ì‹œ', callback_data = 'ëŒ€ì „ê´‘ì—­ì‹œ')\n",
    "reg8 = BT(text = 'ë¶€ì‚°ê´‘ì—­ì‹œ', callback_data = 'ë¶€ì‚°ê´‘ì—­ì‹œ')\n",
    "reg9 = BT(text = 'ì„œìš¸íŠ¹ë³„ì‹œ', callback_data = 'ì„œìš¸íŠ¹ë³„ì‹œ')\n",
    "reg10 = BT(text = 'ì„¸ì¢…ì‹œ', callback_data = 'ì„¸ì¢…ì‹œ')\n",
    "reg11 = BT(text = 'ìš¸ì‚°ê´‘ì—­ì‹œ', callback_data = 'ìš¸ì‚°ê´‘ì—­ì‹œ')\n",
    "reg12 = BT(text = 'ì¸ì²œê´‘ì—­ì‹œ', callback_data = 'ì¸ì²œê´‘ì—­ì‹œ')\n",
    "reg13 = BT(text = 'ì „ë¼ë‚¨ë„', callback_data = 'ì „ë¼ë‚¨ë„')\n",
    "reg14 = BT(text = 'ì „ë¼ë¶ë„', callback_data = 'ì „ë¼ë¶ë„')\n",
    "reg15 = BT(text = 'ì œì£¼ë„', callback_data = 'ì œì£¼ë„')\n",
    "reg16 = BT(text = 'ì¶©ì²­ë‚¨ë„', callback_data = 'ì¶©ì²­ë‚¨ë„')\n",
    "reg17 = BT(text = 'ì¶©ì²­ë¶ë„', callback_data = 'ì¶©ì²­ë¶ë„')\n",
    "reg18 = BT(text = 'ì „êµ­', callback_data = 'ì „êµ­')\n",
    "reg_mu = MU(inline_keyboard = [[reg1, reg2,reg3],\n",
    "                              [reg4, reg5,reg6],\n",
    "                              [reg7, reg8,reg9],\n",
    "                              [reg10, reg11,reg12],\n",
    "                              [reg13, reg14,reg15],\n",
    "                              [reg16, reg17,reg18]])\n",
    "\n",
    "# ìê²©ìš”ê±´ - í•™ë ¥\n",
    "edu1 = BT(text = 'ê³ êµ ì¬í•™', callback_data = 'ê³ êµ ì¬í•™')\n",
    "edu2 = BT(text = 'ê³ ì¡¸', callback_data = 'ê³ ì¡¸')\n",
    "edu3 = BT(text = 'ëŒ€í•™ ì¬í•™', callback_data = 'ëŒ€í•™ ì¬í•™')\n",
    "edu4 = BT(text = 'ëŒ€ì¡¸', callback_data = 'ëŒ€ì¡¸')\n",
    "edu5 = BT(text = 'ëŒ€í•™ì› ì¬í•™', callback_data = 'ëŒ€í•™ì› ì¬í•™')\n",
    "edu6 = BT(text = 'ëŒ€í•™ì› ì¡¸ì—…', callback_data = 'ëŒ€í•™ì› ì¡¸ì—…')\n",
    "edu7 = BT(text = 'ì œí•œì—†ìŒ', callback_data = 'ì œí•œì—†ìŒ')\n",
    "edu_mu = MU(inline_keyboard = [[edu1, edu2, edu3],\n",
    "                              [edu4, edu5, edu6],\n",
    "                              [edu7]])\n",
    "\n",
    "# ìê²©ìš”ê±´ - ì·¨ì—…ì—¬ë¶€\n",
    "work1 = BT(text = 'ë¯¸ì·¨ì—…ì', callback_data = 'ë¯¸ì·¨ì—…ì')\n",
    "work2 = BT(text = 'ì¬ì§ì', callback_data = 'ì¬ì§ì')\n",
    "work3 = BT(text = 'ì œí•œì—†ìŒ', callback_data = 'ì œí•œì—†ìŒ')\n",
    "work_mu = MU(inline_keyboard = [[work1, work2, work3]]) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "policy = pd.read_csv('using_data/policy_content.csv', encoding = 'euc-kr')\n",
    "condition = pd.read_csv('using_data/policy_condition_real_final.csv', encoding = 'euc-kr')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "bot = telegram.Bot(token = token)\n",
    "updates = bot.getUpdates()\n",
    "\n",
    "def start(update, context):\n",
    "    bot.sendMessage(chat_id=update.effective_chat.id, text='ì•ˆë…•í•˜ì„¸ìš”. ë‹¹ì‹ ì—ê²Œ ë”± ë§ëŠ” ì·¨ì—…ì •ì±…! ì²­ë°”ì§€ğŸ‘–ì…ë‹ˆë‹¤! \\nì·¨ì—… ì •ì±… ì°¾ê¸° í˜ë“œì…¨ë‚˜ìš”? \\nìê²© ìš”ê±´ ì•Œì•„ë³´ê¸° ë²ˆê±°ë¡œìš°ì…¨ë‚˜ìš”? \\nê·¸ëŸ¼ ì˜ ì˜¤ì…¨ì–´ìš”. \\nì €í¬ê°€ ì°¾ì•„ë“œë¦´ê²Œìš” ğŸ˜')\n",
    "    bot.sendMessage(chat_id=update.effective_chat.id, text=\"ì¶”ì²œì— ì•ì„œ ì €í¬ê°€ ë” ë‚˜ì€ ì„œë¹„ìŠ¤ë¡œ ë°œì „í•˜ê¸° ìœ„í•´ ë‹¹ì‹ ì˜ ìƒë‹´ê¸€ì„ ì €ì¥í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤. \\nì €í¬ ì„œë¹„ìŠ¤ëŠ” ì² ì €í•œ ìµëª…ì´ ë³´ì¥ë©ë‹ˆë‹¤.\\n/agree ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”~\")\n",
    "\n",
    "updater = Updater(token=token, use_context=True) \n",
    "dispatcher = updater.dispatcher \n",
    "\n",
    "def btn_agree_first(update, context):\n",
    "    agree_markup = agree_mu_first # make markup\n",
    "    update.message.reply_text(\"ìƒë‹´ê¸€ ì €ì¥ì— ë™ì˜í•˜ì‹­ë‹ˆê¹Œ?\", reply_markup=agree_markup)\n",
    "\n",
    "get_handler_first = CommandHandler('agree', btn_agree_first)\n",
    "updater.dispatcher.add_handler(get_handler_first)                               \n",
    "        \n",
    "###########\n",
    "\n",
    "# def Question(update, context): \n",
    "#     context.bot.send_message(chat_id=update.effective_chat.id, text= 'ì·¨ì—… ê´€ë ¨ ê³ ë¯¼ì„ ì ì–´ì£¼ì„¸ìš”!')\n",
    "\n",
    "def echo(update, context): \n",
    "    your_policy = findpolicy.find_your_policy(update.message.text).reset_index(drop = True)\n",
    "    text1 = 'ë‹¹ì‹ ì—ê²Œ ì¶”ì²œë“œë¦¬ëŠ” ì •ì±…ì€..\\nã€Œ{}ã€ ì…ë‹ˆë‹¤!\\n\\nâ— ì •ì±… ë‚´ìš©: \\n{} \\n\\nâ— ì§€ì› ìƒì„¸ë‚´ìš©: \\n{} \\n\\nâ†“ì •ì±…ëª…ì„ ê²€ìƒ‰í•´ë³´ì„¸ìš”! \\n{}'.format(your_policy.iloc[0,1], your_policy.iloc[0,2], your_policy.iloc[0,3], your_policy.iloc[0,4])\n",
    "    text2 = 'í˜¹ì‹œ ë§ˆìŒì— ë“¤ì§€ ì•Šìœ¼ì‹œë‹¤ë©´ ê·¸ ì™¸ì˜ ì¶”ì²œ ì •ì±…ì…ë‹ˆë‹¤! \\n\\nâ—† 2ìˆœìœ„:ã€Œ{}ã€ \\nì •ì±… ê²€ìƒ‰ â†’ {} \\n\\nâ—† 3ìˆœìœ„:ã€Œ{}ã€ \\nì •ì±… ê²€ìƒ‰ â†’ {} \\n\\nâ—† 4ìˆœìœ„:ã€Œ{}ã€ \\nì •ì±… ê²€ìƒ‰ â†’ {} \\n\\nâ—† 5ìˆœìœ„:ã€Œ{}ã€ \\nì •ì±… ê²€ìƒ‰ â†’ {}'.format(your_policy.iloc[1,1],your_policy.iloc[1,4],your_policy.iloc[2,1],your_policy.iloc[2,4],your_policy.iloc[3,1],your_policy.iloc[3,4],your_policy.iloc[4,1],your_policy.iloc[4,4])\n",
    "    text3 = 'ë„ì›€ì´ ë˜ì…¨ë‚˜ìš”?ğŸ˜Š \\nì¶”ì²œëœ ì •ì±…ì˜ ì§€ì›ëŒ€ìƒì¸ì§€ ê°„ë‹¨íˆ í™•ì¸í•´ë“œë¦´ ìˆ˜ ìˆì–´ìš”.\\ní™•ì¸ì„ ì›í•˜ì‹œë©´ /info ë¥¼ í´ë¦­í•´ì£¼ì„¸ìš”. \\nì•½ê°„ì˜ ê°œì¸ì •ë³´ë¥¼ ìš”êµ¬í•©ë‹ˆë‹¤.'\n",
    "    context.bot.send_message(chat_id=update.effective_chat.id, text = text1)\n",
    "    context.bot.send_message(chat_id=update.effective_chat.id, text = text2)\n",
    "    context.bot.send_message(chat_id=update.effective_chat.id, text = text3)\n",
    "    \n",
    "    query = \"insert into text_table(test) values('{}')\".format(update.message.text)\n",
    "\n",
    "    session.execute(query)\n",
    "    session.execute(\"commit\")\n",
    "\n",
    "################################\n",
    "    \n",
    "def btn_agree(update, context):\n",
    "    agree_markup = agree_mu # make markup\n",
    "    update.message.reply_text(\"ê°œì¸ì •ë³´ ìˆ˜ì§‘ì— ë™ì˜í•˜ì‹­ë‹ˆê¹Œ?\", reply_markup=agree_markup)\n",
    "    \n",
    "def callback_get(update, context):\n",
    "    \n",
    "    if update.callback_query.data == 'ì˜ˆ' :\n",
    "        context.bot.edit_message_text(text=\"ë™ì˜í•˜ì…¨ìŠµë‹ˆë‹¤. ì·¨ì—… ê´€ë ¨ ê³ ë¯¼ì„ ì ì–´ì£¼ì„¸ìš”!\",\n",
    "                                      chat_id=update.callback_query.message.chat_id,\n",
    "                                      message_id=update.callback_query.message.message_id)\n",
    "    \n",
    "    if update.callback_query.data == 'ì•„ë‹ˆì˜¤' :\n",
    "        context.bot.edit_message_text(text=\"ë¹„ë™ì˜í•˜ì…¨ìŠµë‹ˆë‹¤.. ì €í¬ ì„œë¹„ìŠ¤ëŠ” ìƒë‹´ê¸€ ìˆ˜ì§‘ì„ ì›í•˜ì§€ ì•Šìœ¼ì‹œë‹¤ë©´ ì•„ì§ ì´ìš©í•˜ì‹œê¸° í˜ë“œì‹­ë‹ˆë‹¤.. \\n ì´ìš©ì„ ì›í•˜ì‹ ë‹¤ë©´ ë‹¤ì‹œ /agree ë¥¼ ì„ íƒí•˜ì…” ë™ì˜í•´ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.\",\n",
    "                                      chat_id=update.callback_query.message.chat_id,\n",
    "                                      message_id=update.callback_query.message.message_id)\n",
    "    \n",
    "    \n",
    "    # ë™ì˜ -> ë‚˜ì´\n",
    "    agree_list = ['ë™ì˜','ë¹„ë™ì˜']\n",
    "    if update.callback_query.data in agree_list :\n",
    "        context.bot.edit_message_text(text=\"{}ë¥¼ ì„ íƒí•˜ì…¨ìŠµë‹ˆë‹¤\".format(update.callback_query.data),\n",
    "                                      chat_id=update.callback_query.message.chat_id,\n",
    "                                      message_id=update.callback_query.message.message_id)\n",
    "        context.bot.sendMessage(mc, 'ë‚˜ì´ë¥¼ ì„ íƒí•˜ì„¸ìš”.', reply_markup = age_mu)\n",
    "    \n",
    "    # ë‚˜ì´ -> ì§€ì—­\n",
    "    age_list = ['00-15', '15-18', '19-24', '25-34', '35-39', '40~99']\n",
    "    if update.callback_query.data in age_list:\n",
    "        context.bot.edit_message_text(text=\"{}\".format(update.callback_query.data),\n",
    "                                      chat_id=update.callback_query.message.chat_id,\n",
    "                                      message_id=update.callback_query.message.message_id)\n",
    "        context.bot.sendMessage(mc, 'ì§€ì—­ì„ ì„ íƒí•˜ì„¸ìš”.', reply_markup = reg_mu)\n",
    "\n",
    "    \n",
    "    # ì§€ì—­ -> ìµœì¢…í•™ë ¥\n",
    "    reg_list = ['ê°•ì›ë„','ê²½ê¸°ë„','ê²½ìƒë‚¨ë„','ê²½ìƒë¶ë„','ê´‘ì£¼ê´‘ì—­ì‹œ','ëŒ€êµ¬ê´‘ì—­ì‹œ','ëŒ€ì „ê´‘ì—­ì‹œ','ë¶€ì‚°ê´‘ì—­ì‹œ','ì„œìš¸íŠ¹ë³„ì‹œ',\n",
    "                'ì„¸ì¢…ì‹œ','ìš¸ì‚°ê´‘ì—­ì‹œ','ì¸ì²œê´‘ì—­ì‹œ','ì „ë¼ë‚¨ë„','ì „ë¼ë¶ë„','ì œì£¼ë„','ì¶©ì²­ë‚¨ë„','ì¶©ì²­ë¶ë„','ì „êµ­']\n",
    "    if update.callback_query.data in reg_list:\n",
    "        context.bot.edit_message_text(text=\"{}\".format(update.callback_query.data),\n",
    "                                      chat_id=update.callback_query.message.chat_id,\n",
    "                                      message_id=update.callback_query.message.message_id)\n",
    "        context.bot.sendMessage(mc, 'ìµœì¢…í•™ë ¥ì„ ì„ íƒí•˜ì„¸ìš”', reply_markup = edu_mu)\n",
    "\n",
    "    \n",
    "    # ìµœì¢…í•™ë ¥ -> ì·¨ì—…ì—¬ë¶€\n",
    "    edu_list = ['ê³ êµ ì¬í•™','ê³ ì¡¸', 'ëŒ€í•™ ì¬í•™','ëŒ€ì¡¸', 'ëŒ€í•™ì› ì¬í•™', 'ëŒ€í•™ì› ì¡¸ì—…', 'ì œí•œì—†ìŒ']\n",
    "    if update.callback_query.data in edu_list:\n",
    "        context.bot.edit_message_text(text=\"{}\".format(update.callback_query.data),\n",
    "                                      chat_id=update.callback_query.message.chat_id,\n",
    "                                      message_id=update.callback_query.message.message_id)\n",
    "        context.bot.sendMessage(mc, 'ì·¨ì—…ì—¬ë¶€ë¥¼ ì„ íƒí•˜ì„¸ìš”.', reply_markup = work_mu)\n",
    "\n",
    "\n",
    "    #ì·¨ì—…ì—¬ë¶€ -> í…ìŠ¤íŠ¸ ì…ë ¥\n",
    "    work_list = ['ë¯¸ì·¨ì—…ì', 'ì¬ì§ì', 'ì œí•œì—†ìŒ']\n",
    "    if update.callback_query.data in work_list:\n",
    "        context.bot.edit_message_text(text=\"{}\".format(update.callback_query.data),\n",
    "                                      chat_id=update.callback_query.message.chat_id,\n",
    "                                      message_id=update.callback_query.message.message_id)\n",
    "        context.bot.sendMessage(mc, \"ì¶”ì²œëœ ì •ì±…ì˜ ì§€ì›ëŒ€ìƒì¸ì§€ í™•ì¸í•˜ê³  ì‹¶ìœ¼ì‹œë‹¤ë©´ /condition ì„ í´ë¦­í•˜ì„¸ìš”!\")\n",
    "    \n",
    "    if update.callback_query.data in age_list:\n",
    "        session.execute(\"UPDATE test2 SET age = '{}'\".format(update.callback_query.data))\n",
    "        session.execute(\"commit\")\n",
    "        \n",
    "    if update.callback_query.data in reg_list:\n",
    "        session.execute(\"UPDATE test2 SET region = '{}'\".format(update.callback_query.data))\n",
    "        session.execute(\"commit\")\n",
    "        \n",
    "    if update.callback_query.data in edu_list:\n",
    "        session.execute(\"UPDATE test2 SET edu = '{}'\".format(update.callback_query.data))\n",
    "        session.execute(\"commit\")\n",
    "        \n",
    "    if update.callback_query.data in work_list:\n",
    "        session.execute(\"UPDATE test2 SET work = '{}'\".format(update.callback_query.data))\n",
    "        session.execute(\"commit\")\n",
    "\n",
    "def check_condition(update, context): \n",
    "    your_policy = findpolicy.find_your_policy(update.message.text).reset_index(drop = True)\n",
    "    your_policy = condition.loc[condition['index'] == your_policy['index'][0]]\n",
    "    df_list = list(pd.read_sql('select * from test2', engine).iloc[0])       # ì‚¬ìš©ì ìê²©ìš”ê±´\n",
    "    temp_list = list(your_policy.iloc[0])   # ì¶”ì²œëœ ì •ì±… 5ê°œ ì¤‘ 1ìœ„\n",
    "\n",
    "    if (int(df_list[0][:2]) >= temp_list[2] and int(df_list[0][-2:]) <= temp_list[3])\\\n",
    "        &(df_list[1] == temp_list[4] or temp_list[4] == 'ì „êµ­')\\\n",
    "        &(df_list[2] == temp_list[5] or temp_list[5] == 'ì œí•œì—†ìŒ')\\\n",
    "        &(df_list[3] == temp_list[7] or temp_list[7] == 'ì œí•œì—†ìŒ'):\n",
    "        context.bot.send_message(chat_id=update.effective_chat.id, text= 'ì¶”ì²œ ì •ì±…ì˜ ì§€ì›ëŒ€ìƒì…ë‹ˆë‹¤~ğŸ¥³ \\në‹¤ë§Œ ì…ë ¥í•œ ì •ë³´ì™¸ì˜ ì¶”ê°€ì ì¸ ì œí•œ ì‚¬í•­ì´ ìˆì„ ìˆ˜ ìˆìœ¼ë‹ˆ í•´ë‹¹ í˜ì´ì§€ í™•ì¸ì„ ë¶€íƒë“œë¦½ë‹ˆë‹¤~ğŸ‘Œ')\n",
    "    else:\n",
    "        context.bot.send_message(chat_id=update.effective_chat.id, text= 'ì•„ì‰½ê²Œë„ ì§€ì›ëŒ€ìƒì´ ì•„ë‹ˆì„¸ìš”ğŸ˜­')\n",
    "\n",
    "dispatcher.add_handler(CommandHandler(\"start\", start))\n",
    "        \n",
    "echo_handler = MessageHandler(Filters.text & (~Filters.command), echo) \n",
    "dispatcher.add_handler(echo_handler)\n",
    "\n",
    "get_handler = CommandHandler('info', btn_agree)\n",
    "updater.dispatcher.add_handler(get_handler)                             \n",
    "updater.dispatcher.add_handler(CallbackQueryHandler(callback_get))\n",
    "\n",
    "dispatcher.add_handler(CommandHandler(\"condition\", check_condition))\n",
    "\n",
    "def filtering(ì¸ì):\n",
    "    df_list = list(df.iloc[0])       # ì‚¬ìš©ì ìê²©ìš”ê±´\n",
    "    temp_list = list(temp.iloc[3])   # ì¶”ì²œëœ ì •ì±… 5ê°œ ì¤‘ 1ìœ„\n",
    "\n",
    "    if (int(df_list[0][:2]) >= temp_list[2] and int(df_list[0][-2:]) <= temp_list[3])\\\n",
    "        &(df_list[1] == temp_list[4] or temp_list[4] == 'ì „êµ­')\\\n",
    "        &(df_list[2] == temp_list[5] or temp_list[5] == 'ì œí•œì—†ìŒ')\\\n",
    "        &(df_list[3] == temp_list[7] or temp_list[7] == 'ì œí•œì—†ìŒ'):\n",
    "        print('ê°€ëŠ¥') # sendmessageë¡œ ìˆ˜ì •\n",
    "    else:\n",
    "        print('ë¶ˆê°€ëŠ¥') # sendmessageë¡œ ìˆ˜ì •\n",
    "\n",
    "updater.start_polling() \n",
    "updater.idle()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
